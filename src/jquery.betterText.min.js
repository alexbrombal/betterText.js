;(function(){if(typeof $==="undefined"){if(typeof jQuery!=="undefined")$=jQuery;else if(typeof require!=="undefined")$=require("jquery");if(typeof $==="undefined")throw"jQuery is required to use this tool."}$.fn.betterText=function(t,n){if(!t||typeof t=="object"&&!n){n=t;t="create"}switch(t){case"object":return $(this).eq(0).closest(".betterText").data("BetterText");case"value":if(n!==undefined)this.each(function(){var e=$(this).betterText("object");e.input.val(n);e.updatePlaceholder()});else return $(this).betterText("object").input.val();break;case"create":var r=this.find(":focus");this.filter("textarea, input[type=text], input[type=password]").each(function(){if($(this).betterText("object"))return;new e(this,n)});r.focus();break;case"validate":var i=true;this.each(function(){var e=$(this).betterText("object");if(e)i&=e.validate(n)});return!!i;break;case"error":this.each(function(){var e=$(this).betterText("object");if(e)e.error(n)})}return this};$.fn.betterText.defaults={wrapper:"<span></span>",placeholder:null,validate:null,inputClass:"",errorGraphic:"&#9660;"};var e=function(t,n){var r=this;this.input=$(t);this.settings=$.extend($.extend({},$.fn.betterText.defaults),n);this.wrapper=$(this.settings.wrapper).addClass("betterText").addClass(this.input[0].tagName.toLowerCase()==="input"?"text":"textarea").mousedown(function(e){if($(e.target).closest(".error").length||e.target===r.input[0])return;setTimeout(function(){r.input.focus()})}).addClass(this.input.attr("class"));this.wrapper.insertAfter(this.input);this.wrapper.append(this.input);this.input.attr("class",this.settings.inputClass);if(this.settings.placeholder===null)this.settings.placeholder=e.isPlaceholderSupported?null:this.input.attr("placeholder");if(this.settings.placeholder){this.placeholder=$('<span class="placeholder"></span>').html(this.settings.placeholder).click(function(){r.input.focus()});this.wrapper.prepend(this.placeholder);this.input.bind("focus blur change keydown keyup",function(e){r.updatePlaceholder(e)})}this.input.bind("focus blur",function(e){$(this).closest(".betterText").toggleClass("focus",e.type=="focus");if(e.type=="blur")r.validate()});$(window).blur(function(){r.input.trigger("change")});$(this.wrapper).data("BetterText",this);e.fields.push(this);this.updatePlaceholder();return this};$.extend(e.prototype,{updatePlaceholder:function(e){if(!this.settings.placeholder)return;if(this.input.val()!="")this.placeholder.css("display","none");else if(e&&e.type=="focus"||this.input.is(":focus"))this.placeholder.css({display:"block",opacity:.5});else this.placeholder.css({display:"block",opacity:1})},validate:function(e){var t=this;var n=false;e=e||this.settings.validate;if(!e){this.error(false);return}var r=function(e){var n="";if(e&&(n=e(t.input.val())))return n;return""};if(e.constructor===Array&&e.length){for(var i=0,s=e.length;i<s;i++)if(n=r(e[i]))break}else if(e.constructor===Function)n=r(e);this.error(n);return!n},error:function(e){var t=this.wrapper.find(".error");if(e){if(typeof e==="string"){if(!t.length)t=$('<span class="error"><span class="arrow"></span><span class="text"></span><a href="" class="close" tabindex="-1"></a></span>').appendTo(this.wrapper);t.find(".arrow").html(this.settings.errorGraphic);t.find(".text").html(e);t.find("a").click(function(){$(this).closest(".error").remove();return false})}this.wrapper.addClass("error");return false}else{t.remove();this.wrapper.removeClass("error");return true}}});e.fields=[];e.updateAll=function(){$.each(e.fields,function(){this.updatePlaceholder()})};e.isPlaceholderSupported="placeholder"in document.createElement("input")})();
